# Security Policy Configuration for Billion Row Tournament
# This file defines security rules and restrictions for tournament submissions

[GENERAL]
# Security level: low, medium, high, maximum
security_level = maximum

# Enable/disable various security features
enable_seccomp = true
enable_apparmor = true
enable_capabilities = true
enable_namespaces = true
enable_cgroups = true
enable_audit = true

# Resource limits
max_memory_gb = 8
max_cpu_cores = 4
max_processes = 10
max_threads = 50
max_file_descriptors = 1024
max_file_size_mb = 10

# Time limits
max_execution_time_seconds = 1800
max_compilation_time_seconds = 300

[NETWORK]
# Network access restrictions
allow_network_access = false
allow_localhost = false
allow_dns = false
allow_http = false
allow_https = false
allow_ftp = false
allow_ssh = false
allow_telnet = false

# Blocked ports
blocked_ports = 22, 23, 25, 53, 80, 443, 3306, 5432, 6379, 8080

[FILESYSTEM]
# File system access restrictions
allow_file_read = true
allow_file_write = false
allow_file_create = false
allow_file_delete = false
allow_file_rename = false
allow_file_move = false
allow_file_copy = false
allow_file_link = false
allow_file_symlink = false

# Allowed directories (read-only)
allowed_directories = /workspace/data, /workspace/submissions, /workspace/temp

# Blocked directories
blocked_directories = /etc, /var, /usr, /bin, /sbin, /lib, /lib64, /home, /root

# Allowed file types
allowed_file_types = .txt, .java, .py, .cpp, .go, .h, .hpp, .c, .cc, .cxx

# Blocked file types
blocked_file_types = .exe, .dll, .so, .dylib, .sh, .bat, .cmd, .ps1, .vbs

[PROCESSES]
# Process restrictions
allow_fork = true
allow_exec = false
allow_system = false
allow_shell = false
allow_background = false
allow_daemon = false

# Blocked commands
blocked_commands = bash, sh, zsh, csh, tcsh, ksh, fish, dash, busybox

# Blocked system calls
blocked_syscalls = execve, execv, execl, execlp, execvp, execvpe, system, popen

[CAPABILITIES]
# Linux capabilities to drop
drop_capabilities = ALL

# Linux capabilities to add (minimal set)
add_capabilities = CHOWN, SETGID, SETUID

# Special capabilities for specific operations
compilation_capabilities = CHOWN, SETGID, SETUID, SYS_ADMIN
execution_capabilities = CHOWN, SETGID, SETUID

[SECCOMP]
# Seccomp profile configuration
seccomp_profile = /workspace/security/seccomp.json
seccomp_action = SCMP_ACT_ERRNO

# Allowed system calls (basic set for program execution)
allowed_syscalls = read, write, open, close, fstat, lseek, mmap, munmap, exit, exit_group

# Blocked system calls
blocked_syscalls = ptrace, clone, fork, vfork, kill, tkill, tgkill, setuid, setgid, chroot

[APPARMOR]
# AppArmor profile configuration
apparmor_profile = tournament-executor
apparmor_mode = enforce

# AppArmor rules
apparmor_rules = 
  deny /proc/sys/** w,
  deny /sys/** w,
  deny /dev/** w,
  deny /etc/** w,
  deny /var/** w,
  deny /usr/** w,
  deny /bin/** w,
  deny /sbin/** w,
  deny /lib/** w,
  deny /lib64/** w,
  deny /home/** w,
  deny /root/** w

[CGROUPS]
# CGroup configuration
cgroup_memory_limit = 8G
cgroup_cpu_limit = 4.0
cgroup_pids_limit = 50
cgroup_io_limit = 100MB

# Memory pressure handling
memory_pressure_level = medium
memory_pressure_action = kill

[AUDIT]
# Audit configuration
audit_enabled = true
audit_rules = 
  -w /workspace -p wa -k tournament_access
  -w /etc/passwd -p wa -k user_modification
  -w /etc/group -p wa -k group_modification
  -w /etc/shadow -p wa -k password_modification
  -w /etc/sudoers -p wa -k sudo_modification

# Audit log configuration
audit_log_file = /workspace/logs/audit.log
audit_log_format = raw
audit_log_size = 100MB
audit_log_rotate = true

[VALIDATION]
# Input validation rules
validate_file_size = true
validate_file_type = true
validate_file_content = true
validate_file_permissions = true

# Pattern matching
blocked_patterns = system(, exec(, eval(, Runtime.exec, ProcessBuilder
suspicious_patterns = import os, import sys, import subprocess, import socket

# Language-specific validation
java_validation = true
python_validation = true
cpp_validation = true
go_validation = true

[MONITORING]
# Resource monitoring
monitor_cpu = true
monitor_memory = true
monitor_disk = true
monitor_network = true
monitor_processes = true

# Monitoring intervals
monitor_interval_seconds = 5
alert_threshold_cpu = 90
alert_threshold_memory = 85
alert_threshold_disk = 90

# Logging configuration
log_level = INFO
log_file = /workspace/logs/security.log
log_format = json
log_rotation = true
log_max_size = 100MB
log_max_files = 10

[REPORTING]
# Security report configuration
generate_security_report = true
report_format = json
report_location = /workspace/logs/security_reports
report_retention_days = 30

# Report contents
include_file_analysis = true
include_pattern_matching = true
include_resource_usage = true
include_security_events = true
include_audit_logs = true

[COMPLIANCE]
# Compliance requirements
compliance_standard = OWASP_TOP_10
compliance_level = high
compliance_reporting = true

# Data protection
data_encryption = false
data_anonymization = true
data_retention_days = 90

# Privacy
collect_personal_data = false
log_user_behavior = false
track_user_activity = false









